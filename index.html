<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Focus Reader</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,500;9..144,700&family=Space+Grotesk:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="https://unpkg.com/lucide@latest/dist/font/lucide.css" />
  </head>
  <body>
    <div class="app">
      <!--       
      <a class="support-banner" href="https://x.com/iruletheworldmo" target="_blank" rel="noopener">
        Enjoying this? Subscribe on X <span>@iruletheworldmo</span> to see more fun projects
      </a> 
      -->

      <header class="hero">
        <div>
          <h1>Focus Reader</h1>
          <p class="subtitle">
            Paste anything, lock your gaze on the red letter, and let the words flow at
            your pace.
          </p>
        </div>
        <div class="stats">
          <div>
            <p class="stat-label">Words</p>
            <p class="stat-value" id="wordCount">0</p>
          </div>
          <div>
            <p class="stat-label">Progress</p>
            <p class="stat-value" id="progress">0%</p>
          </div>
        </div>
      </header>

      <main class="layout">
        <section class="panel reader-panel" id="readerPanel">
          <div class="reader-toolbar">
            <div class="reader-label">
              <span>Focus View</span>
              <span class="reader-doc" id="readerDoc">No document loaded</span>
            </div>
            <div class="toolbar-actions">
                <button id="customizeBtn" class="ghost">
                  <i data-lucide="settings" class="icon"></i>
                  <span>Customize</span>
                </button>
                <button id="toggleControlsBtn" class="ghost">
                  <i data-lucide="sliders" class="icon"></i>
                  <span>Controls</span>
                </button>
                <button id="fullscreenBtn" class="ghost">
                  <i data-lucide="maximize" class="icon"></i>
                  <span>Fullscreen</span>
                </button>
              </div>
          </div>

          <div class="customize-panel closed" id="customizePanel">
            <div class="customize-group">
              <p class="customize-title">Focus Letter</p>
              <label class="toggle">
                <input id="focusHighlightToggle" type="checkbox" checked />
                <span>Highlight focus letter</span>
              </label>
              <div class="color-row">
                <input id="focusColorPicker" type="color" value="#ff3b30" aria-label="Focus color" />
                <button class="color-swatch" data-focus-color="#ff3b30" style="--swatch: #ff3b30;">Red</button>
                <button class="color-swatch" data-focus-color="#ffffff" style="--swatch: #ffffff;">White</button>
                <button class="color-swatch" data-focus-color="#36a3ff" style="--swatch: #36a3ff;">Blue</button>
                <button class="color-swatch" data-focus-color="#32d74b" style="--swatch: #32d74b;">Green</button>
              </div>
            </div>
          </div>

          <div class="reader" aria-live="polite">
            <div class="gaze-line"></div>
            <div class="word-display" id="wordDisplay">
              <span class="word-left"></span>
              <span class="word-focus"></span>
              <span class="word-right"></span>
            </div>
            <p class="live-wpm" id="liveWpm"></p>
          </div>

          <div class="reader-controls" id="readerControls">
            <div class="controls-centered">
              <button class="primary" data-action="pause">
                <i data-lucide="play" class="icon"></i>
                <span>Start</span>
              </button>
              <button data-action="reset">
                <i data-lucide="rotate-ccw" class="icon"></i>
                <span>Restart</span>
              </button>
            </div>

            <div class="reader-jump">
              <button data-action="back10">
                <i data-lucide="skip-back" class="icon"></i>
                <span>-10</span>
              </button>
              <button data-action="rewind3">
                <i data-lucide="rewind" class="icon"></i>
                <span>Rewind 3s</span>
              </button>
              <button data-action="forward10">
                <i data-lucide="skip-forward" class="icon"></i>
                <span>+10</span>
              </button>
            </div>

            <div class="speed-slider">
              <span class="speed-label-min">120</span>
              <div class="slider-track">
                <input
                  id="speedRange"
                  type="range"
                  min="120"
                  max="900"
                  value="300"
                  step="10"
                  aria-label="Reading speed"
                />
              </div>
              <span class="speed-label-max">900</span>
            </div>
            <p class="wpm-display"><span id="wpmValue">300</span> WPM</p>
          </div>

          <div class="reader-options-bar">
            <button class="context-toggle hidden" id="contextToggle">
              <i data-lucide="book-open" class="icon"></i>
              <span>Show Context</span>
            </button>

            <div class="auto-pace" id="autoPace">
              <label class="auto-pace-toggle" id="autoPaceLabel">
                <input type="checkbox" id="autoPaceToggle" />
                <span>Auto Pace</span>
                <i data-lucide="chevron-up" class="icon settings-chevron"></i>
              </label>
              <div class="auto-pace-settings" id="autoPaceSettings">
                <div class="auto-pace-settings-header">
                  <p>Auto-Pace Settings</p>
                  <button class="ghost close-settings" id="closePaceSettings">
                    <i data-lucide="x" class="icon"></i>
                  </button>
                </div>
                <div class="auto-pace-fields">
                  <div class="pace-field">
                    <label>Start</label>
                    <input type="number" id="startPace" value="150" min="60" max="900" step="10" />
                  </div>
                  <div class="pace-field">
                    <label>Max</label>
                    <input type="number" id="maxPace" value="400" min="60" max="900" step="10" />
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Context Modal -->
          <div class="modal-overlay hidden" id="contextModal">
            <div class="modal">
              <div class="modal-header">
                <h2>Reading Context</h2>
                <button class="ghost close-modal" id="closeContextModal">
                  <i data-lucide="x" class="icon"></i>
                </button>
              </div>
              <div class="modal-body" id="modalContextBody">
                <!-- Context text will be injected here -->
              </div>
              <div class="modal-footer">
                <div class="modal-nav">
                  <button class="ghost" id="modalPrevParagraph">
                    <i data-lucide="chevron-left" class="icon"></i>
                    <span>Previous</span>
                  </button>
                  <button class="ghost" id="modalNextParagraph">
                    <span>Next</span>
                    <i data-lucide="chevron-right" class="icon"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="panel input-panel">
          <!-- Controls Section -->
          <div class="controls-section hidden">
            <div class="controls">
              <button id="pauseBtn" class="primary" data-action="pause">
                <i data-lucide="play" class="icon"></i>
                <span>Start</span>
              </button>
              <button id="resetBtn" data-action="reset">
                <i data-lucide="rotate-ccw" class="icon"></i>
                <span>Reset</span>
              </button>
            </div>

            <div class="hint">
              Tip: <span>Space</span> start/pause ¬∑ <span>R</span> reset ¬∑ <span>‚Üê ‚Üí</span> step ¬∑ <span>Shift + ‚Üê ‚Üí</span> jump 10 ¬∑ <span>C</span> context
            </div>
          </div>

          <!-- Document Input Section -->
          <div class="input-section hidden">
            <div class="field">
              <label for="docTitle">Document title</label>
              <input
                id="docTitle"
                type="text"
                placeholder="Give this document a name (optional)"
              />
            </div>

            <div class="field">
              <label for="textInput">Paste your text</label>
              <textarea
                id="textInput"
                placeholder="Drop anything here ‚Äî articles, notes, books. Press Ctrl+V to paste text quickly."
              ></textarea>
            </div>
            
            <div class="input-hints">
              <p class="hint-text">Quick tips: Press <span class="key">Ctrl+N</span> to create a new entry, <span class="key">Ctrl+S</span> to save, or drag and drop files directly into this area.</p>
            </div>
          </div>

          <!-- File Upload Section -->
          <div class="upload-section hidden">
            <p class="section-title">Or upload a file</p>
            
            <div class="file-row">
              <input id="pdfInput" type="file" accept="application/pdf" />
              <label class="file-button" for="pdfInput">
                <span class="file-icon">üìÑ</span>
                Upload PDF
              </label>
              <p class="file-status" id="pdfStatus">No PDF loaded</p>
            </div>

            <div class="file-row">
              <input id="epubInput" type="file" accept=".epub,application/epub+zip" />
              <label class="file-button" for="epubInput">
                <span class="file-icon">üìñ</span>
                Upload EPUB
              </label>
              <p class="file-status" id="epubStatus">No EPUB loaded</p>
            </div>

            <label class="toggle">
              <input id="ocrToggle" type="checkbox" />
              <span>OCR scanned PDFs (slower, but reads image-only pages)</span>
            </label>
          </div>

          <!-- History Section -->
          <div class="history-section">
            <p class="history-title">Progress History</p>
            <div class="history-row">
              <span>Last read</span>
              <span id="historyLastRead">‚Äî</span>
            </div>
            <div class="history-row">
              <span>Sessions</span>
              <span id="historySessions">0</span>
            </div>
            <div class="history-row">
              <span>Time spent</span>
              <span id="historyTime">0m</span>
            </div>
          </div>

          <!-- Library Section -->
          <div class="library-section">
            <div class="library-header">
              <p class="library-title">Library</p>
              <div class="library-header-actions">
                  <button id="addEntryBtn" class="ghost">
                    <i data-lucide="plus" class="icon"></i>
                    <span>Add Entry</span>
                  </button>
                  <button id="clearLibraryBtn" class="ghost">
                    <i data-lucide="trash-2" class="icon"></i>
                    <span>Clear</span>
                  </button>
                </div>
            </div>
            
            <div class="library-search-container">
              <i data-lucide="search" class="icon search-icon"></i>
              <input type="text" id="librarySearch" placeholder="Search your library..." aria-label="Search library" />
            </div>

            <p class="library-empty" id="libraryEmpty">No saved documents yet.</p>
            <ul class="library-list" id="libraryList"></ul>
          </div>

          <div class="drop-overlay" id="dropOverlay">
            <div class="drop-content">
              <div class="drop-icon">üìÅ</div>
              <p>Drop a PDF or EPUB to load</p>
            </div>
          </div>
        </section>
      </main>
      

    </div>

    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/epubjs@0.3.88/dist/epub.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
